






<!doctype html>
<html lang="zh-CN">
<head>
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <meta name="author" content="sutong">
  
  
  
  
    <meta name="description" content="论文后缀数组——处理字符串的有力工具–罗穗骞
题目
例3            (1).cogs902:Musical Theme(poj1743)
#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstring&gt;
using namespace std;
const int aaa = 1e5+1;
const ...">
  
  <title>后缀数组十三题 [ ST ]</title>
  
  
    <link rel="shortcut icon" href="/favicon.ico">
  
  
  <link rel="stylesheet" href="/css/random.css">
<link rel="stylesheet" href="/css/vegas.min.css">
<link rel="stylesheet" href="/css/highlight-railscasts.css">
<link rel="stylesheet" href="/css/jquery.fancybox.css">
<link rel="stylesheet" href="/css/iconfont/iconfont.css">
<link rel="stylesheet" href="/css/jquery.fancybox-thumbs.css">
<link rel="stylesheet" href="/css/plyr.css">
  
</head>

<body>
<div class="side-navigate hide-area">
  
  
</div>
<div id="outer-container" class="hide-area">
<div id="container">
  <div id="menu-outer" class="slide-down">
    <div id="menu-inner">
      <div id="brand">
        
        <a onClick="openUserCard()">
          <img id="avatar" src="https://raw.githubusercontent.com/ProSTKhala/ProSTKhala.github.io/master/images/ST.jpg"/>
          <div id="homelink">ST</div>
        </a>
      </div>
      <div id="menu-list">
        <ul>
        
        
          
            <li>
          
            <a href="/index.html">Home</a>
            
          </li>
        
          
            <li>
          
            <a href="/archives">Archives</a>
            
          </li>
        
          
            <li>
          
            <a href="/tags">Tags</a>
            
          </li>
        
          
            <li>
          
            <a href="/categories">Categories</a>
            
          </li>
        
          
            <li>
          
            <a href="/about">About</a>
            
          </li>
        
          
            <li>
          
            <a href="https://github.com/ProSTKhala/ProSTKhala.github.io">Github</a>
            
          </li>
        
        </ul>
      </div>
      <div id="show-menu">
        <button>Menu</button>
      </div>
    </div>
  </div>

  <div id="content-outer">
    <div id="content-inner">
      
      
  <article id="post">
    <h1>后缀数组十三题</h1>
    <p class="page-title-sub">
      <span id = "post-title-date">撰写于 2017-03-08</span>
      
        <span id = "post-title-updated">修改于 2017-03-08</span>
      
      
      <span id = "post-title-categories">分类
      
      
        
        
        <a href="/categories/Hollerith-type/">Hollerith-type</a>
      
      </span>
      
      
      <span id = "post-title-tags">
      标签
      
      
        
        
        <a href="/tags/后缀数组/">后缀数组</a>
      
      </span>
      
    </p>
    
    <h1 id="论文"><a href="#论文" class="headerlink" title="论文"></a>论文</h1><p><a href="https://github.com/ProSTKhala/ProSTKhala.github.io/blob/master/pdfs/%E7%AE%97%E6%B3%95%E5%90%88%E9%9B%86%E4%B9%8B%E3%80%8A%E5%90%8E%E7%BC%80%E6%95%B0%E7%BB%84%E2%80%94%E2%80%94%E5%A4%84%E7%90%86%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%9C%89%E5%8A%9B%E5%B7%A5%E5%85%B7%E3%80%8B.pdf" target="_blank" rel="external">后缀数组——处理字符串的有力工具–罗穗骞</a></p>
<h1 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h1><hr>
<p>例3            (1).<a href="http://cogs.pro/cogs/problem/problem.php?pid=902" target="_blank" rel="external">cogs902:Musical Theme</a>(poj1743)</p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstring&gt;
using namespace std;
const int aaa = 1e5+1;
const int maxf = 255;
const int inf = 0x7fffffff;
int wa[aaa],wb[aaa],wv[aaa],tong[aaa],h[aaa],sa[aaa],rank[aaa],d[aaa];
int s[aaa];
int cmp(int *r,int a,int b,int l){return r[a]==r[b]&amp;&amp;r[a+l]==r[b+l];}
void da(int n,int m)
{
int i,j,p,*x=wa,*y=wb;
for(i=0;i&lt;m;i++)tong[i]=0;
for(i=0;i&lt;n;++i)tong[x[i]=s[i]]++;
for(i=1;i&lt;m;++i)tong[i]+=tong[i-1];
for(i=n-1;i&gt;=0;--i)sa[--tong[x[i]]]=i;
for(p=1,j=1;p&lt;n;j&lt;&lt;=1,m=p)
{
    for(p=0,i=n-j;i&lt;n;++i)y[p++]=i;
    for(i=0;i&lt;n;++i)if(sa[i]&gt;=j)y[p++]=sa[i]-j;
    for(i=0;i&lt;n;++i)wv[i]=x[y[i]];
    for(i=0;i&lt;m;i++)tong[i]=0;
    for(i=0;i&lt;n;++i)tong[wv[i]]++;
    for(i=1;i&lt;m;++i)tong[i]+=tong[i-1];
    for(i=n-1;i&gt;=0;--i)sa[--tong[wv[i]]]=y[i];
    for(swap(x,y),p=1,x[sa[0]]=0,i=1;i&lt;n;++i)
    x[sa[i]]=cmp(y,sa[i-1],sa[i],j)?p-1:p++;
}
return;
}
void getheight(int n)
{
int i,j,k=0;
for(i=1;i&lt;=n;++i)rank[sa[i]]=i;
for(i=0;i&lt;n;h[rank[i++]]=k)
for(k?k--:0,j=sa[rank[i]-1];s[i+k]==s[j+k];k++);
return;
}
bool can(int k,int n)
{
int tmp=0,maxsa=-1,minsa=inf;
for(int i=1;i&lt;=n;++i)
{
    if(h[i]&lt;k)maxsa=-1,minsa=inf;
    if(sa[i]&lt;minsa)minsa=sa[i];
    if(sa[i]&gt;maxsa)maxsa=sa[i];
    if(maxsa-minsa&gt;k)return 1;
}
return 0;
}
int main()
{
//    freopen(&quot;theme.in&quot;,&quot;r&quot;,stdin);
//    freopen(&quot;theme.out&quot;,&quot;w&quot;,stdout);
int n,x;
while(scanf(&quot;%d&quot;,&amp;n)!=EOF)
{
    memset(h,0,sizeof(h));
    memset(sa,0,sizeof(sa));
    memset(rank,0,sizeof(rank));
    if(!n)break;
    cin&gt;&gt;x;
    for(int i=1;i&lt;n;++i)scanf(&quot;%d&quot;,&amp;s[i]);
    s[0]=s[1]-x;
    for(int i=1;i&lt;n-1;++i)s[i]=s[i+1]-s[i];
    n--;
    for(int i=0;i&lt;n;++i)s[i]+=150;
    da(n+1,maxf);
    getheight(n);
    int l=0,r=1e6,ans;
    int mid=0;
    while(l!=r)
    {
        ans=l+r+1&gt;&gt;1;
        if(can(ans,n))    l=ans;
        else            r=ans-1;
    }
    l++;
    printf(&quot;%d\n&quot;,(l)&gt;=5?l:0);
}
}
</code></pre><p><a href="https://raw.githubusercontent.com/ProSTKhala/ProSTKhala.github.io/master/codes/%E5%90%8E%E7%BC%80%E6%95%B0%E7%BB%8413%E9%A2%98.%E4%BE%8B3.cpp" target="_blank" rel="external">CODE</a></p>
<hr>
<p>例4            (1).<a href="http://poj.org/problem?id=3261" target="_blank" rel="external">poj3261：Milk Patterns</a></p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstring&gt;
using namespace std;
const int maxf = 255;
const int inf = 0x7fffffff;
const int aaa = 1e5+5;
int sa[aaa],tong[aaa],wa[aaa],wb[aaa],wv[aaa],rank[aaa],height[aaa];
int s[aaa],k;
int cmp(int*r,int a,int b,int l)
{return r[a]==r[b]&amp;&amp;r[a+l]==r[b+l];}
void da(int n,int m)
{
    int i,j,p,*x=wa,*y=wb;
    for(i=0;i&lt;m;++i)tong[i]=0;
    for(i=0;i&lt;n;++i)tong[x[i]=s[i]]++;
    for(i=1;i&lt;m;++i)tong[i]+=tong[i-1];
    for(i=n-1;i&gt;=0;--i)sa[--tong[x[i]]]=i;
    for(j=1,p=1;p&lt;n;j&lt;&lt;=1,m=p)
    {
        for(p=0,i=n-j;i&lt;n;++i)y[p++]=i;
        for(i=0;i&lt;n;++i)if(sa[i]&gt;=j)y[p++]=sa[i]-j;
        for(i=0;i&lt;n;++i)wv[i]=x[y[i]];
        for(i=0;i&lt;m;i++)tong[i]=0;
        for(i=0;i&lt;n;i++)tong[wv[i]]++;
        for(i=1;i&lt;m;i++)tong[i]+=tong[i-1];
        for(i=n-1;i&gt;=0;i--)sa[--tong[wv[i]]]=y[i];
        for(swap(x,y),p=1,x[sa[0]]=0,i=1;i&lt;n;i++)
        x[sa[i]]=cmp(y,sa[i-1],sa[i],j)?p-1:p++;
    }
    return;
}
void getheight(int n)
{
    int i,j,k=0;
    for(i=1;i&lt;=n;++i)rank[sa[i]]=i;
    for(i=0;i&lt;n;height[rank[i++]]=k)
    for(k?k--:0,j=sa[rank[i]-1];s[i+k]==s[j+k];k++);
    return;
}
bool can(int ans,int n)
{
    int tot=0;
    for(int i=1;i&lt;=n;++i)
    {
        if(height[i]&lt;ans)tot=0;
        tot++;
        if(tot==k)return 1;
    }
    return 0;
}
int main()
{
    int n;
    scanf(&quot;%d%d&quot;,&amp;n,&amp;k);
    for(int i=0;i&lt;n;++i)scanf(&quot;%d&quot;,s+i);
    da(n+1,maxf);
    getheight(n);
    int l=1,r=n+1,ans,mid;
    while(l!=r)
    {
        int mid=(l+r&gt;&gt;1)+1;
        if(can(mid,n))ans=l=mid;
        else        r=mid-1;
    }
    printf(&quot;%d\n&quot;,ans);
}
</code></pre><p><a href="https://raw.githubusercontent.com/ProSTKhala/ProSTKhala.github.io/master/codes/%E5%90%8E%E7%BC%80%E6%95%B0%E7%BB%8413%E9%A2%98.%E4%BE%8B4.cpp" target="_blank" rel="external">CODE</a></p>
<hr>
<p>例5            (1).<a href="https://vjudge.net/problem/SPOJ-DISUBSTR" target="_blank" rel="external">spoj694：Distinct Substrings</a>(Vjudge)        </p>
<pre><code>#include&lt;iostream&gt; 
#include&lt;cstring&gt;
#include&lt;cstdio&gt;
const int aaa =1e4+5;       
using namespace std;       
char s[aaa];   
int sa[aaa],wa[aaa],wb[aaa],tong[aaa],wv[aaa];      
int rank[aaa],height[aaa];      
int cmp(int*r,int a,int b,int l)
{return r[a]==r[b]&amp;&amp;r[a+l]==r[b+l];}
void da(int n,int m)
{
    int i,j,p,*x=wa,*y=wb;
    for(i=0;i&lt;m;++i)tong[i]=0;
    for(i=0;i&lt;n;++i)tong[x[i]=s[i]]++;
    for(i=1;i&lt;m;++i)tong[i]+=tong[i-1];
    for(i=n-1;i&gt;=0;--i)sa[--tong[x[i]]]=i;
    for(j=1,p=1;p&lt;n;j&lt;&lt;=1,m=p)
    {
        for(p=0,i=n-j;i&lt;n;++i)y[p++]=i;
        for(i=0;i&lt;n;++i)if(sa[i]&gt;=j)y[p++]=sa[i]-j;
        for(i=0;i&lt;n;++i)wv[i]=x[y[i]];
        for(i=0;i&lt;m;i++)tong[i]=0;
        for(i=0;i&lt;n;i++)tong[wv[i]]++;
        for(i=1;i&lt;m;i++)tong[i]+=tong[i-1];
        for(i=n-1;i&gt;=0;i--)sa[--tong[wv[i]]]=y[i];
        for(swap(x,y),p=1,x[sa[0]]=0,i=1;i&lt;n;i++)
        x[sa[i]]=cmp(y,sa[i-1],sa[i],j)?p-1:p++;
    }
    return;
}
void calheight(int n)
{
    int i,j,k=0;
    for(i=1;i&lt;=n;i++) rank[sa[i]]=i;
    for(i=0;i&lt;n;height[rank[i++]]=k)
    for(k?k--:0,j=sa[rank[i]-1];s[i+k]==s[j+k];k++);
    return;
}
int main()  
{  
    int t;  
    scanf(&quot;%d&quot;,&amp;t);  
    while(t--)  
    {  
        int i;  
        scanf(&quot;%s&quot;,s);  
        int n=strlen(s);   
        da(n+1,128);  
        calheight(n);  
        long long ans=n*(n+1)/2;  
        for(i=1;i&lt;=n;i++)  
        ans-=height[i];  
        printf(&quot;%lld\n&quot;,ans);  
    }  
}  
</code></pre><p><a href="https://raw.githubusercontent.com/ProSTKhala/ProSTKhala.github.io/master/codes/%E5%90%8E%E7%BC%80%E6%95%B0%E7%BB%8413%E9%A2%98.%E4%BE%8B5.cpp" target="_blank" rel="external">CODE</a></p>
<p>(2).<a href="http://cogs.pro/cogs/problem/problem.php?pid=1709" target="_blank" rel="external">cogs1709:不同的子串</a> （spoj705）</p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstring&gt;
using namespace std;
const int aaa = 1e5+1;
const int maxf = 255;
int wa[aaa],wb[aaa],wv[aaa],tong[aaa],sa[aaa],rank[aaa],h[aaa];
char s[aaa];
bool cmp(int*r,int a,int b,int l){return r[a]==r[b]&amp;&amp;r[a+l]==r[b+l];}
void da(int n,int m)
{
    int i,j,p,*x=wa,*y=wb;
    for(i=0;i&lt;m;++i)tong[i]=0;
    for(i=0;i&lt;n;++i)tong[x[i]=s[i]]++;
    for(i=1;i&lt;m;++i)tong[i]+=tong[i-1];
    for(i=n-1;i&gt;=0;i--)sa[--tong[x[i]]]=i;
    for(j=1,p=1;p&lt;n;j&lt;&lt;=1,m=p)
    {
        for(p=0,i=n-j;i&lt;n;++i)y[p++]=i;
        for(i=0;i&lt;n;++i)if(sa[i]&gt;=j)y[p++]=sa[i]-j;
        for(i=0;i&lt;n;++i)wv[i]=x[y[i]];
        for(i=0;i&lt;m;++i)tong[i]=0;
        for(i=0;i&lt;n;++i)tong[wv[i]]++;
        for(i=1;i&lt;m;++i)tong[i]+=tong[i-1];
        for(i=n-1;i&gt;=0;--i)sa[--tong[wv[i]]]=y[i];
        for(swap(x,y),p=1,i=1,x[sa[0]]=0;i&lt;n;++i)
        x[sa[i]]=cmp(y,sa[i-1],sa[i],j)?p-1:p++;
    }
    return;
}
void getheight(int n)
{
    int i,j,k=0;
    for(i=1;i&lt;=n;++i)rank[sa[i]]=i;
    for(i=0;i&lt;n;h[rank[i++]]=k)
    for(k?k--:0,j=sa[rank[i]-1];s[i+k]==s[j+k];k++);
    return;
}
int main()
{
//    freopen(&quot;subst1.in&quot;,&quot;r&quot;,stdin);
//    freopen(&quot;subst1.out&quot;,&quot;w&quot;,stdout);
    scanf(&quot;%s&quot;,s);
    int n=strlen(s);
    da(n+1,maxf);
    getheight(n);
    for(int i=1;i&lt;=n;++i)sa[i]++;
    long long ans=0;
    for(int i=1;i&lt;=n;++i)ans+=n-sa[i]-(i==1?0:h[i])+1;
    printf(&quot;%d&quot;,ans);
}
</code></pre><p><a href="https://raw.githubusercontent.com/ProSTKhala/ProSTKhala.github.io/master/codes/%E5%90%8E%E7%BC%80%E6%95%B0%E7%BB%8413%E9%A2%98.%E4%BE%8B5.2.cpp" target="_blank" rel="external">CODE</a></p>
<hr>
<p>例6            (1).<a href="https://vjudge.net/problem/URAL-1297" target="_blank" rel="external">ural1297：Palindrome</a>(Vjudge)</p>
<pre><code>#include&lt;cstring&gt;
#include&lt;cstdlib&gt;
#include&lt;cstdio&gt;
#include&lt;iostream&gt;
#include&lt;cmath&gt;
using namespace std;
const int aaa = 1e4+1;
int tong[aaa],wv[aaa],wa[aaa],wb[aaa];
int rank1[aaa],height[aaa],sa[aaa];
char s[aaa];
int a[aaa],n;
int dp[aaa][30];
int cmp(int *r,int a,int b,int l){return r[a]==r[b]&amp;&amp;r[a+l]==r[b+l];}
void da(int n,int m)
{
    int i,j,p,*x=wa,*y=wb;
    for(i=0;i&lt;m;++i)tong[i]=0;
    for(i=0;i&lt;n;++i)tong[x[i]=a[i]]++;
    for(i=1;i&lt;m;++i)tong[i]+=tong[i-1];
    for(i=n-1;i&gt;=0;--i)sa[--tong[x[i]]]=i;
    for(j=1,p=1;p&lt;n;j&lt;&lt;=1,m=p)
    {
        for(p=0,i=n-j;i&lt;n;++i)y[p++]=i;
        for(i=0;i&lt;n;++i)if(sa[i]&gt;=j)y[p++]=sa[i]-j;
        for(i=0;i&lt;n;++i)wv[i]=x[y[i]];
        for(i=0;i&lt;m;i++)tong[i]=0;
        for(i=0;i&lt;n;i++)tong[wv[i]]++;
        for(i=1;i&lt;m;i++)tong[i]+=tong[i-1];
        for(i=n-1;i&gt;=0;i--)sa[--tong[wv[i]]]=y[i];
        for(swap(x,y),p=1,x[sa[0]]=0,i=1;i&lt;n;i++)
        x[sa[i]]=cmp(y,sa[i-1],sa[i],j)?p-1:p++;
    }
  return;
}

void calheight(int n)
{
    int i,j,k=0;
    for(i=1;i&lt;=n;i++)rank1[sa[i]]=i;
    for(i=0;i&lt;n;height[rank1[i++]]=k)
    for(k?k--:0,j=sa[rank1[i]-1];a[i+k]==a[j+k];k++);
    return;
}

void preRMQ()
{
    int i,j;
    memset(dp,127,sizeof(dp));
    for(i=1;i&lt;=n*2+1;i++)dp[i][0]=height[i];
    for(j=1;(1&lt;&lt;j)&lt;=2*n+1;j++)
    for(i=1;i+(1&lt;&lt;j)-1&lt;=2*n+1;i++)
    dp[i][j]=min(dp[i][j-1],dp[i+(1&lt;&lt;(j-1))][j-1]);
}

int lcp(int l,int r)
{
    int a=rank1[l],b=rank1[r];
    if(a&gt;b)
        swap(a,b);
    a++;
    int t=(int)(log(double(b-a+1))/log(2.00));
    return min(dp[a][t],dp[b-(1&lt;&lt;t)+1][t]);
}

int main()
{
    int i,res,flag,max;
    while(scanf(&quot;%s&quot;,s)!=EOF)
    {
        max=0;
        n=strlen(s);
        for(i=0;i&lt;n;i++)a[i]=(int)s[i];
        a[n]=1;
        for(i=0;i&lt;n;i++)a[i+n+1]=int(s[n-i-1]);
        a[2*n+1]=0;
        da(2*n+2,123);
        calheight(2*n+1);
        preRMQ();
        for(i=0;i&lt;n;i++)
        {
            res=lcp(i,2*n-i)*2-1;
            if(max&lt;res)        max=res,flag=i;
            if(i&gt;0)
            {
                res=lcp(i,2*n-i+1)*2;
                if(max&lt;res)    max=res,flag=i;
            }
        }
        if(max%2==1)for(i=flag-max/2;i&lt;=flag+max/2;i++)        printf(&quot;%c&quot;,s[i]);
        else        for(i=flag-max/2;i&lt;=flag+max/2-1;i++)    printf(&quot;%c&quot;,s[i]);
        printf(&quot;\n&quot;);
    }
}
</code></pre><p><a href="https://raw.githubusercontent.com/ProSTKhala/ProSTKhala.github.io/master/codes/%E5%90%8E%E7%BC%80%E6%95%B0%E7%BB%8413%E9%A2%98.%E4%BE%8B6.cpp" target="_blank" rel="external">CODE</a></p>
<hr>
<p>例7             (1).<a href="http://cogs.pro/cogs/problem/problem.php?pid=1710" target="_blank" rel="external">cogs1710:Power Strings</a>     （poj2406）(本题正解为DC3或KMP，倍增会TLE)</p>
<hr>
<p> 例8            (1).<a href="http://poj.org/problem?id=3693" target="_blank" rel="external">poj3693:Maximum repetition substring</a></p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstring&gt;
using namespace std;
const int aaa = 1e5+1;
const int maxf = 255;
int sa[aaa],h[aaa],wa[aaa],wb[aaa],wv[aaa],tong[aaa],pre[aaa],rank[aaa];
int k,now,jj,maxr,cnt;
int d[aaa][21],ans[aaa];
char s[aaa*2];
bool cmp(int *r,int a,int b,int l){return r[a]==r[b]&amp;&amp;r[a+l]==r[b+l];}

void da(int n,int m)
{
    int i,j,p,*x=wa,*y=wb;
    for(i=0;i&lt;m;++i)tong[i]=0;
    for(i=0;i&lt;n;++i)tong[x[i]=s[i]]++;
    for(i=1;i&lt;m;++i)tong[i]+=tong[i-1];
    for(i=n-1;i&gt;=0;--i)sa[--tong[x[i]]]=i;
    for(j=1,p=1;p&lt;n;j&lt;&lt;=1,m=p)
    {
        for(p=0,i=n-j;i&lt;n;++i)y[p++]=i;
        for(i=0;i&lt;n;++i)if(sa[i]&gt;=j)y[p++]=sa[i]-j;
        for(i=0;i&lt;m;++i)tong[i]=0;
        for(i=0;i&lt;n;++i)wv[i]=x[y[i]];
        for(i=0;i&lt;n;++i)tong[wv[i]]++;
        for(i=1;i&lt;m;++i)tong[i]+=tong[i-1];
        for(i=n-1;i&gt;=0;--i)sa[--tong[wv[i]]]=y[i];
        for(swap(x,y),p=1,x[sa[0]]=0,i=1;i&lt;n;++i)
        x[sa[i]]=cmp(y,sa[i-1],sa[i],j)?p-1:p++;
    }
}
void getheight(int n)
{
    int i,j,k=0;
    for(i=1;i&lt;=n;++i)rank[sa[i]]=i;
    for(i=0;i&lt;n;h[rank[i++]]=k)
    for(k?k--:0,j=sa[rank[i]-1];s[i+k]==s[j+k];k++);
}
int prermq(int*a,int n)
{
    for(int i=0;i&lt;n;++i)d[i][0]=a[i];
    for(int j=1;(1&lt;&lt;j)&lt;=n;++j)
    for(int i=0;i+(1&lt;&lt;j)-1&lt;n;++i)
    d[i][j]=min(d[i][j-1],d[i+(1&lt;&lt;(j-1))][j-1]);
}
int askrmq(int l,int r)
{
    l=rank[l],r=rank[r];
    if(l&gt;r)swap(l,r);
    l++;
    int k=0;
    while((1&lt;&lt;(k+1))&lt;=r-l+1)k++;
    return min(d[l][k],d[r-(1&lt;&lt;k)+1][k]);
}
int main()
{
    int ccase=0;
    while(1)
    {
    memset(h,0,sizeof(h));
    memset(d,0,sizeof(d));
    memset(tong,0,sizeof(tong));
    memset(rank,0,sizeof(rank));
    memset(ans,0,sizeof(ans));
    ccase++;

    k=now=jj=maxr=cnt=0;
    scanf(&quot;%s&quot;,s);
    if(s[0]==&apos;#&apos;)return 0;
    int n=strlen(s);
    da(n+1,maxf);
    getheight(n);
    prermq(h,n+1);
    for(int i=1;i&lt;n;++i) 
    for(int j=0;j+i&lt;n;j+=i) 
    {
        k=askrmq(j,j+i);
        now=k/i+1;
        jj=j-(i-k%i);
        if (jj&gt;=0&amp;&amp;askrmq(jj,jj+i)&gt;=(i-k%i))++now;
        if(now&gt;maxr)        {cnt=0;maxr=now;ans[cnt++]=i;}
        else if(now==maxr)    ans[cnt++]=i;
    }
        for(int i=1;i&lt;=n;++i) 
        for(int j=0;j&lt;cnt;++j)
        if(askrmq(sa[i],sa[i]+ans[j])&gt;=(maxr-1)*ans[j])
        {
            jj=sa[i],k=ans[j];
            goto dd;
        }
        dd:;
        printf(&quot;Case %d: &quot;,ccase);
        for (int i=0;i&lt;maxr*k;++i)putchar(s[jj++]);
        printf(&quot;\n&quot;);
    }
}
</code></pre><p><a href="https://raw.githubusercontent.com/ProSTKhala/ProSTKhala.github.io/master/codes/%E5%90%8E%E7%BC%80%E6%95%B0%E7%BB%8413%E9%A2%98.%E4%BE%8B8.cpp" target="_blank" rel="external">CODE</a></p>
<p>(2).<a href="http://cogs.pro/cogs/problem/problem.php?pid=1711" target="_blank" rel="external">cogs1711:重复的字符串</a> （spoj687）</p>
<hr>
<p>例9           (1).<a href="http://cogs.pro/cogs/problem/problem.php?pid=1713" target="_blank" rel="external">cogs1713:Long Long Message</a>     （poj2774）</p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstring&gt;
using namespace std;
const int aaa = 3e5+1;
const int maxf = 255;
const int inf =0x7fffffff;
int sa[aaa],wa[aaa],wb[aaa],wv[aaa],tong[maxf+1],rank[aaa],h[aaa];
char s[aaa],ss[aaa];
bool cmp(int *r,int a,int b,int l){return r[a]==r[b]&amp;&amp;r[a+l]==r[b+l];}
void da(int n,int m)
{
    int i,j,p,*x=wa,*y=wb;
    for(i=0;i&lt;m;++i)tong[i]=0;
    for(i=0;i&lt;n;++i)tong[x[i]=s[i]]++;
    for(i=1;i&lt;m;++i)tong[i]+=tong[i-1];
    for(i=n-1;i&gt;=0;--i)sa[--tong[x[i]]]=i;
    for(j=1,p=1;p&lt;n;m=p,j&lt;&lt;=1)
    {
        for(p=0,i=n-j;i&lt;n;++i)y[p++]=i;
        for(i=0;i&lt;n;++i)if(sa[i]&gt;=j)y[p++]=sa[i]-j;
        for(i=0;i&lt;n;++i)wv[i]=x[y[i]];
        for(i=0;i&lt;m;++i)tong[i]=0;
        for(i=0;i&lt;n;++i)tong[wv[i]]++;
        for(i=1;i&lt;m;++i)tong[i]+=tong[i-1];
        for(i=n-1;i&gt;=0;--i)sa[--tong[wv[i]]]=y[i];
        for(swap(x,y),p=1,i=1,x[sa[0]]=0;i&lt;n;++i)
        x[sa[i]]=cmp(y,sa[i-1],sa[i],j)?p-1:p++;
    }
    return;
}
void geth(int n)
{
    int i,j,k=0;
    for(i=1;i&lt;=n;++i)rank[sa[i]]=i;
    for(i=0;i&lt;n;h[rank[i++]]=k)
    for(k?k--:0,j=sa[rank[i]-1];s[i+k]==s[j+k];k++);
}
int main()
{
    freopen(&quot;longlongmessage.in&quot;,&quot;r&quot;,stdin);
    freopen(&quot;longlongmessage.out&quot;,&quot;w&quot;,stdout);
    scanf(&quot;%s&quot;,s);
    scanf(&quot;%s&quot;,ss);
    int n=strlen(s),m=strlen(ss);
    s[n]=&apos;*&apos;;
    for(int i=n+1;i&lt;=n+m;++i)s[i]=ss[i-n-1];
    int l=n+m+1;
    da(l+1,maxf);
    geth(l);
    int maxx=0;
    for(int i=2;i&lt;=l;++i)
    {
        if(h[i]&gt;maxx&amp;&amp;((sa[i]&lt;n&amp;&amp;sa[i-1]&gt;n)||(sa[i]&gt;n&amp;&amp;sa[i-1]&lt;n)))
        maxx=h[i];
    }
    cout&lt;&lt;maxx;
}
</code></pre><p><a href="https://raw.githubusercontent.com/ProSTKhala/ProSTKhala.github.io/master/codes/%E5%90%8E%E7%BC%80%E6%95%B0%E7%BB%8413%E9%A2%98.%E4%BE%8B9.tag.cpp" target="_blank" rel="external">CODE</a></p>
<hr>
<p>例10         (1).<a href="http://cogs.pro/cogs/problem/problem.php?pid=1712" target="_blank" rel="external">cogs1712:Common Substrings</a>     （poj3415）</p>
<hr>
<p>例11         (1).<a href="http://cogs.pro/cogs/problem/problem.php?pid=2128" target="_blank" rel="external">cogs2128:生命形态</a>     （poj3294）</p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstring&gt;
#include&lt;algorithm&gt;
using namespace std;
const int aaa = 2e5+1;
const int inf =0x7fffffff;
const int maxf = 255;
bool cmp(int *r,int a,int b,int l){return r[a]==r[b]&amp;&amp;r[a+l]==r[b+l];}
int sa[aaa],wa[aaa],wb[aaa],wv[aaa],rank[aaa],h[aaa],tong[aaa];
char ss[111][10001],s[aaa];
int nn[111],tt;
bool inq[111];
int ll[aaa];
void da(int n,int m)
{
    int i,j,p,*x=wa,*y=wb;
    for(i=0;i&lt;m;++i)tong[i]=0;
    for(i=0;i&lt;n;++i)tong[x[i]=s[i]]++;
    for(i=1;i&lt;m;++i)tong[i]+=tong[i-1];
    for(i=n-1;i&gt;=0;--i)sa[--tong[x[i]]]=i;
    for(j=1,p=1;p&lt;n;j&lt;&lt;=1,m=p)
    {
        for(p=0,i=n-j;i&lt;n;++i)y[p++]=i;
        for(i=0;i&lt;n;++i)if(sa[i]&gt;=j)y[p++]=sa[i]-j;
        for(i=0;i&lt;m;++i)tong[i]=0;
        for(i=0;i&lt;n;++i)tong[wv[i]=x[y[i]]]++;
        for(i=1;i&lt;m;++i)tong[i]+=tong[i-1];
        for(i=n-1;i&gt;=0;--i)sa[--tong[wv[i]]]=y[i];
        for(i=1,p=1,swap(x,y),x[sa[0]]=0;i&lt;n;++i)
        x[sa[i]]=cmp(y,sa[i-1],sa[i],j)?p-1:p++;
    }
    return;
}
void geth(int n)
{
    int i,j,k=0;
    for(i=1;i&lt;=n;++i)rank[sa[i]]=i;
    for(i=0;i&lt;n;h[rank[i++]]=k)
    for(j=sa[rank[i]-1],k?k--:0;s[j+k]==s[i+k];k++);
}
int k;
int ansg;
bool can(int ans,int n,int flag)
{
    if(!flag)
    {
        int tot1=0;
        memset(inq,0,sizeof(inq));
        for(int i=1;i&lt;=n;++i)
        {
            if(h[i]&lt;ans)
            {
                memset(inq,0,sizeof(inq));    tot1=0;
            }
            else
            {
                int nowq,nowt;
                for(int t=1;t&lt;=tt;++t)if(nn[t-1]&lt;sa[i-1]&amp;&amp;sa[i-1]&lt;nn[t])nowt=t;
                for(int t=1;t&lt;=tt;++t)if(nn[t-1]&lt;sa[i]&amp;&amp;sa[i]&lt;nn[t])nowq=t;
                if(!inq[nowq])tot1++,inq[nowq]=true;
                if(!inq[nowt])tot1++,inq[nowt]=true;
                if(tot1&gt;=k)return 1;
            }
        }
        return 0;
    }
    if(flag)
    {
      int lll=inf,rrr=-1;
      int tot1=0;
      memset(inq,0,sizeof(inq));
      for(int i=1;i&lt;=n;++i)
      {
          if(h[i]&lt;ans)
          {
              memset(inq,0,sizeof(inq));    tot1=0;
              lll=inf;rrr=-1;
          }
          else
          {
              int nowq,nowt;
              if(sa[i-1]&lt;lll)lll=sa[i-1];if(sa[i-1]&gt;rrr)rrr=sa[i-1];
              if(sa[i]&lt;lll)lll=sa[i];if(sa[i]&gt;rrr)rrr=sa[i];
              for(int t=1;t&lt;=tt;++t)if(nn[t-1]&lt;sa[i-1]&amp;&amp;sa[i-1]&lt;nn[t])nowt=t;
              for(int t=1;t&lt;=tt;++t)if(nn[t-1]&lt;sa[i]&amp;&amp;sa[i]&lt;nn[t])nowq=t;
              if(!inq[nowq])tot1++,inq[nowq]=true;
              if(!inq[nowt])tot1++,inq[nowt]=true;
              if(tot1==k)ll[++ansg]=lll;
          }
      }
  }
}
  int main()
  {
  //    freopen(&quot;Lifeforms.in&quot;,&quot;r&quot;,stdin);
  //    freopen(&quot;Lifeforms.out&quot;,&quot;w&quot;,stdout);
      while(scanf(&quot;%d&quot;,&amp;tt)!=EOF)
      {
          if(!tt)return 0;
          memset(wa,0,sizeof(wa));
          memset(wb,0,sizeof(wb));
          memset(wv,0,sizeof(wv));
          memset(rank,0,sizeof(rank));
          memset(sa,0,sizeof(sa));
          memset(h,0,sizeof(h));
          memset(nn,0,sizeof(nn));
          memset(s,0,sizeof(s));
          int tot=0;
          int tmp=2;
          ansg=0;
          for(int i=1;i&lt;=tt;++i)
          {
              scanf(&quot;%s&quot;,ss[i]);
              nn[i]=strlen(ss[i]);
              nn[0]=-1;
              for(int t=0;t&lt;nn[i];++t)s[tot++]=ss[i][t];
              nn[i]+=nn[i-1]+(i==tt?0:1);
              if(i!=tt)s[tot++]=tmp++;
          }
          nn[tt]++;
          int n=strlen(s);
          da(n+1,maxf);
          geth(n);
          k=(tt)/2+1;
          int l=0,r=n+1,mid;
          while(l!=r)
          {
              mid=(l+r+1)&gt;&gt;1;
              if(can(mid,n,0))    l=mid;
              else            r=mid-1;
          }
          if(l==0){printf(&quot;?&quot;);goto dd;}
          can(l,n,1);
          for(int i=1;i&lt;=ansg;++i)
          {
              if(i!=1)
              {
              bool flag=0;
              for(int t=0;t&lt;l;++t)if(s[ll[i]+t]!=s[ll[i-1]+t]){flag=1;break;}
              if(!flag)continue;
              }
              for(int t=ll[i];t&lt;=ll[i]+l-1;++t)putchar(s[t]);
              printf(&quot;\n&quot;);
          }
          dd:;
      }
  }
</code></pre><p><a href="https://raw.githubusercontent.com/ProSTKhala/ProSTKhala.github.io/master/codes/%E5%90%8E%E7%BC%80%E6%95%B0%E7%BB%8413%E9%A2%98.%E4%BE%8B11.cpp" target="_blank" rel="external">CODE</a></p>
<hr>
<p>例12         (1).<a href="http://cogs.pro/cogs/problem/problem.php?pid=2120" target="_blank" rel="external">cogs2120:破译进攻计划</a>     （spoj220）</p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstring&gt;
#include&lt;cmath&gt;
using namespace std;
const int aaa = 2e5+500;
const int maxf = 255;
int sa[aaa],rank[aaa],wa[aaa],wb[aaa],wv[aaa],h[aaa],tong[aaa],nn[aaa];
char s[aaa],ss[13][15031];
int inq[13],maxq[13],minq[13];
int tt,num;
bool use[13];
bool cmp(int *r,int a,int b,int l){return r[a]==r[b]&amp;&amp;r[a+l]==r[b+l];}
void da(int n,int m)
{
    int i,j,p,*x=wa,*y=wb;
    for(i=0;i&lt;m;++i)tong[i]=0;
    for(i=0;i&lt;n;++i)tong[x[i]=s[i]]++;
    for(i=1;i&lt;m;++i)tong[i]+=tong[i-1];
    for(i=n-1;i&gt;=0;i--)sa[--tong[x[i]]]=i;
    for(j=1,p=1;p&lt;n;j&lt;&lt;=1,m=p)
    {
        for(p=0,i=n-j;i&lt;n;++i)y[p++]=i;
        for(i=0;i&lt;n;++i)if(sa[i]&gt;=j)y[p++]=sa[i]-j;
        for(i=0;i&lt;m;++i)tong[i]=0;
        for(i=0;i&lt;n;++i)tong[wv[i]=x[y[i]]]++;
        for(i=1;i&lt;m;++i)tong[i]+=tong[i-1];
        for(i=n-1;i&gt;=0;--i)sa[--tong[wv[i]]]=y[i];
        for(swap(x,y),x[sa[0]]=0,i=1,p=1;i&lt;n;++i)
        x[sa[i]]=cmp(y,sa[i-1],sa[i],j)?p-1:p++;
    }
}
void geth(int n)
{
    int i,j,k=0;
    for(i=1;i&lt;=n;++i)rank[sa[i]]=i;
    for(i=0;i&lt;n;h[rank[i++]]=k)
    for(k?k--:0,j=sa[rank[i]-1];s[i+k]==s[j+k];k++);
}
bool can(int ans,int n)
{
    int tot=0;
    for(int i=1;i&lt;=n;++i)
    {
        if(h[i]&lt;ans)
        {
            tot=0;
            memset(inq,0,sizeof(inq));
            memset(maxq,0,sizeof(maxq));
            memset(minq,0x3f,sizeof(minq));
            memset(use,0,sizeof(use));
        }
        else
        {
            for(int t=1;t&lt;=num;++t)if(nn[t-1]&lt;sa[i]&amp;&amp;sa[i]&lt;=nn[t])
            {
                inq[t]++;
                minq[t]=min(minq[t],sa[i]);
                maxq[t]=max(maxq[t],sa[i]);
                if(maxq[t]-minq[t]&gt;=ans&amp;&amp;!use[t])tot++,use[t]=true;
                if(tot==num)return 1;
            }
            for(int t=1;t&lt;=num;++t)if(nn[t-1]&lt;sa[i-1]&amp;&amp;sa[i-1]&lt;nn[t])
            {
                inq[t]++;
                minq[t]=min(minq[t],sa[i-1]);
                maxq[t]=max(maxq[t],sa[i-1]);
                if(maxq[t]-minq[t]&gt;=ans&amp;&amp;!use[t])tot++,use[t]=true;
                if(tot==num)return 1;
            }
        }    
    }
    return 0;
}
int main()
{
//    freopen(&quot;RelevantPhrasesofAnnihil.in&quot;,&quot;r&quot;,stdin);
//    freopen(&quot;RelevantPhrasesofAnnihil.out&quot;,&quot;w&quot;,stdout);
    nn[0]=-1;
    scanf(&quot;%d&quot;,&amp;tt);
    while(tt--)
    {
        memset(inq,0,sizeof(inq));
        memset(wa,0,sizeof(wa));
        memset(wb,0,sizeof(wb));
        memset(wv,0,sizeof(wv));
        memset(sa,0,sizeof(sa));
        memset(rank,0,sizeof(rank));
        memset(h,0,sizeof(h));
        scanf(&quot;%d&quot;,&amp;num);
        int tot=0,qiguaizifu=2;
        for(int i=1;i&lt;=num;++i)
        {
            scanf(&quot;%s&quot;,ss[i]);
            nn[i]=strlen(ss[i]);
        }
        for(int i=1;i&lt;=num;++i)
        {
            for(int t=0;t&lt;nn[i];++t)
            s[tot++]=ss[i][t];
            s[tot++]=qiguaizifu++;
        }
        for(int i=1;i&lt;=num;++i)nn[i]+=(nn[i-1]+1);
        int n=strlen(s);
        da(n+1,maxf);
        geth(n);
        int l=0,r=(n+1)/2;
        while(l!=r)
        {
            int mid=l+r+1&gt;&gt;1;
            if(can(mid,n))    l=mid;
            else            r=mid-1;
        }
        printf(&quot;%d\n&quot;,l);
    }
}
</code></pre><p><a href="https://github.com/ProSTKhala/ProSTKhala.github.io/blob/master/codes/%E5%90%8E%E7%BC%80%E6%95%B0%E7%BB%8413%E9%A2%98.%E4%BE%8B12.cpp" target="_blank" rel="external">CODE</a></p>
<hr>
<p>例13         (1).<a href="http://poj.org/problem?id=1226" target="_blank" rel="external">poj1226:Substrings</a></p>

  </article>
  <div class="random-toc-area">
  <button class="btn-hide-toc btn-hide-toc-show" style="display: none" onclick="TOCToggle()">显示目录</button>
  <button class="btn-hide-toc btn-hide-toc-hide" onclick="TOCToggle()">隐藏目录</button>
  <div class="random-toc">
    <h2>目录</h2>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#论文"><span class="toc-text">论文</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#题目"><span class="toc-text">题目</span></a></li></ol>
  </div>
</div>

  
<nav id="pagination">
  

  

  
</nav>

  <!-- JiaThis Button BEGIN -->

<!-- JiaThis Button END -->


      
      
      
    </div>
  </div>

  <div id="bottom-outer">
    <div id="bottom-inner">
      Site by sutong using
      <a href="http://hexo.io">Hexo</a> & <a href="https://github.com/stiekel/hexo-theme-random">Random</a>
      <br>
      
    </div>
  </div>
</div>

</div>



<div id="user-card">
  <div class="center-field">
    <img class="avatar" src="https://raw.githubusercontent.com/ProSTKhala/ProSTKhala.github.io/master/images/ST.jpg">
    <p id="description"></p>
    <ul class="social-icon">
  
  
    <li>
      <a href="https://github.com/ProSTKhala/ProSTKhala.github.io">
        
          <i class="icon iconfont github">&#xe606;</i>
        
      </a>
    </li>
  
    <li>
      <a href="/">
        
          Coding.NET
        
      </a>
    </li>
  
    <li>
      <a href="/">
        
          Twitter
        
      </a>
    </li>
  
    <li>
      <a href="/">
        
          Weibo
        
      </a>
    </li>
  
    <li>
      <a href="/">
        
          DouBan
        
      </a>
    </li>
  
</ul>
  </div>
</div>


<div id="btn-view">Hide</div>

<script>
// is trigger analytics / tongji script
var isIgnoreHost = false;

if(window && window.location && window.location.host) {
  isIgnoreHost = ["localhost","127.0.0.1"].some(function(address){
    return 0 === window.location.host.indexOf(address);
  });
}

var isTriggerAnalytics = !( true && isIgnoreHost );

</script>




  
  
    <script src="/js/jquery-2.2.3.min.js"></script>
  
    <script src="/js/vegas.min.js"></script>
  
    <script src="/js/random.js"></script>
  
    <script src="/js/highlight.pack.js"></script>
  
    <script src="/js/jquery.mousewheel.pack.js"></script>
  
    <script src="/js/jquery.fancybox.pack.js"></script>
  
    <script src="/js/jquery.fancybox-thumbs.js"></script>
  
    <script src="/js/plyr.js"></script>
  

<script>

  // fancybox
  var backgroundImages = [];
  
  $('#post').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox') || $(this).parent().hasClass('fancybox-thumb')) return;
      var alt = this.alt || this.title;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'post' + i);
    });
  });
  $(".fancybox").fancybox();

var vegasConfig = {"preload­Image":true,"transition":["slideLeft2","slideRight2","flash2"],"timer":true,"delay":5000,"shuffle":true,"count":28};
var unsplashConfig = {"gravity":"north"};
// is show background images
var turnoffBackgroundImage = false;



  turnoffBackgroundImage = true;


var backgroundColor = "34495E";

$(".fancybox-thumb").fancybox({
  prevEffect: 'none',
  nextEffect: 'none',
  helpers: {
    title: {
      type: 'outside'
    },
    thumbs: {
      width: 50,
      height: 50
    }
  }
});

// show video with plyr
$(".video-container iframe").each(function(i){
  var url = $(this).attr('src');
  var id = url.split('/').pop();
  var plyrContainer = document.createElement('div');
  plyrContainer.className = 'plyr';
  var plyrElement = document.createElement('div');
  plyrElement.dataset.videoId = id;
  switch(true) {
    case url.search('youtube.com') >= 0:
      plyrElement.dataset.type = 'youtube';
      break;
    case url.search('vimeo.com') >= 0:
      plyrElement.dataset.type = 'vimeo';
      break;
    default:
      return;
  };
  plyrContainer.appendChild(plyrElement);
  $(this).parent().html(plyrContainer);
});
plyr.setup('.plyr', {iconUrl: '/css/sprite.svg'});
</script>
</body>
</html>

